<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Phpactor</title>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link rel="stylesheet" href="https://phpactor.github.io/phpactor/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://phpactor.github.io/phpactor/css/highlight.tomorrow-night.css">
        <link rel="stylesheet" href="https://phpactor.github.io/phpactor/css/main.css">
    </head>
    <body>

        <main class="container-fluid">
            <div class="row">

                    <nav id="sidebar" class="col-sm-3 col-lg-2" role="navigation">
                        <div class="logo">
<center>
							<a href="https://phpactor.github.io/phpactor"><img src="https://phpactor.github.io/phpactor/images/logo-small.png" /></a>
							<br/>
							<b>Phpactor</b><br/> <i>Intelligent completion and refactoring tool for PHP</i>
</center>
						</div>

                                                    <p class="text-muted">
                                Home
                            </p>

                            <ul class="nav nav-pills nav-stacked">
                                                                    <li class="">
                                        <a href="https://phpactor.github.io/phpactor/index.html">
                                            About
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                Usage
                            </p>

                            <ul class="nav nav-pills nav-stacked">
                                                                    <li class="">
                                        <a href="https://phpactor.github.io/phpactor/standalone.html">
                                            Standalone
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://phpactor.github.io/phpactor/vim-plugin.html">
                                            VIM plugin
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://phpactor.github.io/phpactor/configuration.html">
                                            Configuration
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                Reference
                            </p>

                            <ul class="nav nav-pills nav-stacked">
                                                                    <li class="">
                                        <a href="https://phpactor.github.io/phpactor/completion.html">
                                            Completion
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://phpactor.github.io/phpactor/navigation.html">
                                            Navigation
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://phpactor.github.io/phpactor/refactorings.html">
                                            Refactorings
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                Other topics
                            </p>

                            <ul class="nav nav-pills nav-stacked">
                                                                    <li class="active">
                                        <a href="https://phpactor.github.io/phpactor/integrations.html">
                                            Integrations
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://phpactor.github.io/phpactor/history.html">
                                            History
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://phpactor.github.io/phpactor/developing.html">
                                            Debugging Phpactor
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://phpactor.github.io/phpactor/rpc.html">
                                            RPC Protocol
                                        </a>
                                    </li>
                                                            </ul>
                        
                    </nav>

                <section class="col-sm-offset-3 col-lg-offset-2 col-sm-9 col-lg-10">
                    <h1 id="integrations">Integrations</h1>
<p>Any PHP application or framework which uses composer in a <em>normal</em> way will
play nicely with Phpactor, for the others there is this page.</p>
<h2 id="drupal-8">Drupal 8</h2>
<h3 id="bootstrapping">Bootstrapping</h3>
<p>Drupal automatically adds its modules to the autoloader during the kernel
boot process. It is therefore necessary to either 1) boot the kernel to have a fully
useful autoloader <em>or</em> 2) to use a different mechanism to add the modules to the Composer autoloader.</p>
<p>Depending on your setup option 1 or 2 will be preferable.</p>
<p>In both cases deregister the autoloader in <code>.phpactor.yml</code>:</p>
<pre><code class="language-yaml"># Bootstrapping Drupal creates lots of implicit global
# dependencies, so we will just keep the Drupal autoloader
# registered and hope for the best.
autoload.deregister: false</code></pre>
<h4 id="option-1-bootstrap-drupal-on-the-fly-to-generate-the-autoloader">Option 1: Bootstrap Drupal on the fly to generate the autoloader</h4>
<p>Create the following bootstrap file <code>autoload_phpactor.php</code>, in (for example)
<code>web/</code>:</p>
<pre><code class="language-php">// web/phpactor_autoload.php
&lt;?php

use Drupal\Console\Core\Utils\DrupalFinder;
use Drupal\Console\Bootstrap\DrupalKernel;
use Symfony\Component\HttpFoundation\Request;

$autoload = require_once __DIR__ . '/autoload.php';

$root = getcwd();

$drupalFinder = new DrupalFinder();
if (!$drupalFinder-&gt;locateRoot($root)) {
    die('DrupalConsole must be executed within a Drupal Site.');
}

chdir($drupalFinder-&gt;getDrupalRoot());

$drupalKernel = DrupalKernel::createFromRequest(
  Request::createFromGlobals(),
  $autoload,
  'dev',
  true,
  $drupalFinder-&gt;getDrupalRoot()
);
$drupalKernel-&gt;boot();
chdir($root);

return $autoload;</code></pre>
<p>Then edit <code>.phpactor.yml</code> to use that:</p>
<pre><code class="language-yaml"># Use the special autoloader above
autoload: web/phpactor_autoload.php</code></pre>
<p>The downside to this option is that it requires access to the DB from your current environment which may be tricky if you are running Drupal inside a VM.</p>
<h4 id="option-2-add-the-modules-into-the-composer-autoloader">Option 2: Add the modules into the Composer autoloader</h4>
<p>This option requires merging in any modules (Drupal, contrib, custom) into the Composer autoloader via a discovery mechanism offered by the <a href="https://github.com/fenetikm/autoload-drupal">Drupal Autoloader</a> composer plugin.</p>
<p>Full details are available in the README for this plugin, however, the short version is that you will need to put the following into your <code>composer.json</code> file:</p>
<pre><code class="language-json">{
    "require": {
        "fenetikm/autoload-drupal": "0.1"
    },
    "extra": {
        "autoload-drupal": {
            "modules": [
              "app/modules/contrib/",
              "app/modules/custom/",
              "app/core/modules/"
            ]
        }
    }
}</code></pre>
<p>and then rebuild your Composer autoloader e.g.</p>
<pre><code class="language-sh">composer autoload-dump</code></pre>
<p>The upside to this option is that it won't require the relatively slow Drupal bootstrap (which will hit the DB) but the downside is that you will have to regenerate the autoloader every time you add / remove a module.</p>
<h4 id="coding-standards">Coding Standards</h4>
<p>Change your local <code>.phpactor.yml</code> to use 2 spaces for indentation:</p>
<pre><code># Drupal CS is 2 spaces
code_transform.indentation: "  "</code></pre>
<div class="alert alert-info">
Code will still be generated using the PSR-2 standard. It would be necessary
to override twig templates in `.phpactor/templates` to rectify this (or just
use a CS fixer).
</div>
                </section>

            </div>

        </main>

        <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
        <script src="//yandex.st/highlightjs/7.5/highlight.min.js"></script>

        <script>
            $(function() {
                $("section>h1").wrap('<div class="page-header" />');
                $("section>h2").each(function (index, value) {
                    $(value).append('&nbsp;<a href="#' + $(value).attr('id') + '"><i class="fa small fa-link"></i></a>');
                });
                // Syntax highlighting
                hljs.initHighlightingOnLoad();
            });
        </script>

		<footer>
<hr />
<center>
			<a href="https://github.com/phpactor/phpactor">
				<i class="fa fa-github"></i>
Fork me on Github!
			</a>
</center>
		</footer>

	</body>
</html>
